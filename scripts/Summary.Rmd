---
title: "AkaikeSummary"
author: "Brian O'Meara"
date: "9/19/2017"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
load("/Users/bomeara/Documents/MyDocuments/GitClones/selac_kl/scripts/KLsummaryresults.rda")
library(MuMIn)
```

## Choosing the correct Akaike penalty term

The AICc is a corrected AIC for small sample size; it is supposed to better estimate Kullback-Leibler distance. However, there remains an unaddressed question in phylogenetics regarding what exactly sample size is. For comparative methods, it is taken as number of taxa, as when comparing Ornstein-Uhlenbeck models (Butler and King, 2004; O'Meara et al. 2006; Beaulieu et al. 2012) or discrete character models (corhmm_____). For evaluating molecular models, it is taken as number of sites (Posada _____). These cannot both be true; especially for discrete models, where the underlying model is ultimately the same between DNA and other discrete traits. 

Jhwueng et al (____) investigated AIC and related measures of KL distance and found no consistent best option. They used a two stage simulation approach to estimate KL distance. This has since been implemented in the [KLchecker package](https://github.com/bomeara/KLchecker). We used this approach to examine a simple example where data were generated under an HKY model fit to the Laurasiatherian dataset of phangorn (_____) and then fit using HKY and JC models. These are fast enough to analyze to confirm our suspicion about both number of characters and number of taxa mattering for dataset size.

The RunKLchecker.R and ParseKL2.R scripts contain the code used for these analyses. In brief, parameters estimated from the Laurasiatherian dataset were used to simulate datasets on random trees made from TreeSim (_____). Number of sites used were 1, 2, 3, 4, 5, 10, 20, 50, 100, 200, 500, and 1000 and number of taxa were 5, 10, 25, 50, 100, and 250. For every simulation, the KL distance between the truth and the HKY and JC models was calculated, as well as the likelihood for each of the models. A global model was constructed:

```
global.model <- lm(KLminusNeg2lnL ~ AICc_ntax_penalty + AICc_nchar_penalty + AICc_ncharTimesntax_penalty 
  + nchar + ntax + logNtax + logNchar + LogNcharTimesNtax + NcharTimesNtax
  + NcharTimesLogNtax + LogNcharTimesLogNtax - 1, data=results.for.model)
```

AIC and relatives are typically of the form `-2 lnL + X`, where `X` can be various penalty terms. The above sums a wide range of penalty terms. The MuMIn package is then used to dredge a series of simpler models from this, limiting each to using only one penalty term.

The best model was

```{r, echo=FALSE}
print(get.models(dredged.model, 1)[[1]])
```

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
